<img alt="image" src="https://github.com/user-attachments/assets/018351c2-dd52-400c-8548-061a607784d1" />



정말 아무것도 없을때


<img alt="image" src="https://github.com/user-attachments/assets/cff09ec7-16e8-429b-9f73-5eebeb1e39e1" />


PieceUdon 72개

GetOwner.IsUserInVR 36개

PieceUpdate 72개

VRCPickup 72개

ObjectSync 72개

54프레임이 나온다

<img alt="image" src="https://github.com/user-attachments/assets/963cc896-6e0f-4393-bc71-3012ca4e25b8" />


PieceUdon 72개

GetOwner.IsUserInVR 36개

PieceUpdate 72개

VRCPickup 72개

ObjectSync 0개

63프레임이 나온다

<img alt="image" src="https://github.com/user-attachments/assets/95f6c4bf-f191-4257-91ae-d891fee8b36b" />


PieceUdon 72개

GetOwner.IsUserInVR 36개

PieceUpdate 72개

VRCPickup 0개

ObjectSync 0개

66프레임이 나온다


이정도면 오차범위 내
VRCPickup은 성능차이가 없다고 봐도 될것이다

<img alt="image" src="https://github.com/user-attachments/assets/587260e0-1c70-4169-b7c1-7c40f61f5eca" />


PieceUdon 0개

GetOwner.IsUserInVR 0개

PieceUpdate 0개

VRCPickup 0개

ObjectSync 0개

이번엔 Udon을 지우고 올려보았다

응? 프레임이 갑자기 올랐다

```

void Update()
{
    AngleHold();
}
void LateUpdate()
{
    AngleHold();
}
void AngleHold()
{
    if (Networking.GetOwner(gameObject).IsUserInVR())
    {
        GetComponent<Rigidbody>().constraints = 0;
    }
}
```

참고로 안에 들어있던 코드는 이것으로 Update안에서 계속 호출되고 있었다

<img alt="image" src="https://github.com/user-attachments/assets/3a90ebb8-df41-4700-ab7b-bbd5623610af" />


PieceUdon 72개

GetOwner.IsUserInVR 0개

PieceUpdate 72개

VRCPickup 0개

ObjectSync 0개

```

void Update()
{
    AngleHold();
}
void LateUpdate()
{
    AngleHold();
}
bool isVR=false;
void AngleHold()
{
    if (isVR)
    {
        GetComponent<Rigidbody>().constraints = 0;
    }
}

public void UpdateIsVR()
{
    isVR = Networking.GetOwner(gameObject).IsUserInVR();
}

public override void OnPickup()
{
    UpdateIsVR();
}
```

얼레? 이렇게 변경해보았으나 그대로였다

즉, GetOwner.IsUserInVR의 문제가 아니였다


<img alt="image" src="https://github.com/user-attachments/assets/4a3c8300-b528-474c-b93a-e534a362f654" />


```

void Update()
{
    AngleHold();
}
void LateUpdate()
{
    AngleHold();
}
void AngleHold()
{
    if (Networking.GetOwner(piece).IsUserInVR())
    {
        if (transform.localRotation != Quaternion.identity)
        {
            transform.localRotation = Quaternion.identity;
        }
    }
}
```

좌표가 변경되었을때만 적용되도록 했더니 프레임이 올랐다

그렇다면 ObjectSync의 무거움도 이해가 된다

내부적으로 각도를 고정시키는 코드가 있을테니까

의아한점은 통상적인 유니티에서는 좌표와 각도를 바꾸는정도는 성능에 아무런 영향이 없다는것이다

rigidbody가 붙은상태에서 이동해서 그런것인가 싶었지만 rigidbody를 삭제해도 프레임이 증가하지 않았다

VRChat만의 문제라고 보는게 좋을것이다. 내부적으로 Log라도 호출하는것일까?

<img alt="image" src="https://github.com/user-attachments/assets/9bd8f1e2-0b74-4789-bd46-9d4f8e45275f" />


Manager,Piston,Stair에 있던 Update에 들어있던 코드들도 0.5초주기 실행으로 변경하여 CPU사용량을 60% 경감했다

이제 코드상에서 할수있는 최적화는 극한까지 했고 

이번엔 사용하지 않을때는 오브젝트들을 오프하는 방법으로 해야겠다 

